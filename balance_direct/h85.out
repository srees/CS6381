Current libzmq version is 4.3.4
Current  pyzmq version is 22.3.0
Main: parse command line arguments
Subscriber interested in listening for these topics: ['light|20']
Getting subscriber object
Binding REP to tcp://10.0.0.85:5580
Getting registry proxy
Initializing Zookeeper connection
=================================
Server IP: 10.0.0.1, Port: 2181;
=================================
Driver::init_driver -- instantiate zk obj: hosts = 10.0.0.1:2181
Driver::init_driver -- state after connect = LOST
Current state is now = CONNECTED
['registry5', 'registry2', 'registry4', 'registry3']
Checking if registries/registry5 exists (it better be)
registries/registry5 znode indeed exists; get value
Connecting to 10.0.0.5:5550
Starting registry monitor loop thread
Registering with tcp://10.0.0.5:5550...
Event: {'event': 2, 'value': 115, 'endpoint': b'tcp://10.0.0.5:5550', 'description': 'EVENT_CONNECT_DELAYED'}
Registration sent
Event: {'event': 1, 'value': 24, 'endpoint': b'tcp://10.0.0.5:5550', 'description': 'EVENT_CONNECTED'}
Event: {'event': 4096, 'value': 0, 'endpoint': b'tcp://10.0.0.5:5550', 'description': 'EVENT_HANDSHAKE_SUCCEEDED'}
Registration received
Waiting for start from registry
Retrieving history...
Getting light|20 from tcp://10.0.0.10:5572
{'Topic': 'light|20', 'Value': 369, 'Sender': '10.0.0.10', 'Sent': 1651556131.1412337, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556146.334779, 'Latency': 0.0}
{'Topic': 'light|20', 'Value': 46, 'Sender': '10.0.0.10', 'Sent': 1651556134.2586815, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556146.335051, 'Latency': 0.0}
{'Topic': 'light|20', 'Value': 57, 'Sender': '10.0.0.10', 'Sent': 1651556136.8772614, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556146.335115, 'Latency': 0.0}
{'Topic': 'light|20', 'Value': 28, 'Sender': '10.0.0.10', 'Sent': 1651556139.1907885, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556146.3351665, 'Latency': 0.0}
{'Topic': 'light|20', 'Value': 293, 'Sender': '10.0.0.10', 'Sent': 1651556140.3988504, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556146.3352218, 'Latency': 0.0}
{'Topic': 'light|20', 'Value': 385, 'Sender': '10.0.0.10', 'Sent': 1651556142.338842, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556146.3353152, 'Latency': 0.0}
{'Topic': 'light|20', 'Value': 275, 'Sender': '10.0.0.10', 'Sent': 1651556143.0423026, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556146.3353631, 'Latency': 0.0}
{'Topic': 'light|20', 'Value': 164, 'Sender': '10.0.0.10', 'Sent': 1651556144.5727541, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556146.335407, 'Latency': 0.0}
{'Topic': 'light|20', 'Value': 290, 'Sender': '10.0.0.10', 'Sent': 1651556144.6734645, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556146.3354511, 'Latency': 0.0}
{'Topic': 'light|20', 'Value': 381, 'Sender': '10.0.0.10', 'Sent': 1651556145.3806407, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556146.335495, 'Latency': 0.0}
Subscribing to tcp://10.0.0.10:5571
Starting update loop thread
Fetching updates from registry 10.0.0.5:5550
Request sent
Starting subscriber listen loop...
Reply received as updatesub
[{'ip': '10.0.0.10', 'port': '5571', 'topics': ['light|20']}]
{'Topic': 'light|20', 'Value': 436, 'Sender': '10.0.0.10', 'Sent': 1651556148.8374925, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556148.8586764, 'Latency': 0.02118396759033203}
{'Topic': 'light|20', 'Value': 493, 'Sender': '10.0.0.10', 'Sent': 1651556149.0412369, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556149.0663385, 'Latency': 0.025101661682128906}
{'Topic': 'light|20', 'Value': 185, 'Sender': '10.0.0.10', 'Sent': 1651556149.449968, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556149.47191, 'Latency': 0.0219419002532959}
{'Topic': 'light|20', 'Value': 21, 'Sender': '10.0.0.10', 'Sent': 1651556150.658721, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556150.6797452, 'Latency': 0.021024227142333984}
{'Topic': 'light|20', 'Value': 208, 'Sender': '10.0.0.10', 'Sent': 1651556151.463045, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556151.4845362, 'Latency': 0.021491289138793945}
{'Topic': 'light|20', 'Value': 76, 'Sender': '10.0.0.10', 'Sent': 1651556151.965866, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556151.9887455, 'Latency': 0.022879362106323242}
{'Topic': 'light|20', 'Value': 168, 'Sender': '10.0.0.10', 'Sent': 1651556153.1761942, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556153.1978235, 'Latency': 0.02162933349609375}
{'Topic': 'light|20', 'Value': 97, 'Sender': '10.0.0.10', 'Sent': 1651556153.276746, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556153.299516, 'Latency': 0.022769927978515625}
{'Topic': 'light|20', 'Value': 490, 'Sender': '10.0.0.10', 'Sent': 1651556153.679332, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556153.7020721, 'Latency': 0.02274012565612793}
{'Topic': 'light|20', 'Value': 487, 'Sender': '10.0.0.10', 'Sent': 1651556155.7928052, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556155.8143742, 'Latency': 0.021569013595581055}
{'Topic': 'light|20', 'Value': 86, 'Sender': '10.0.0.10', 'Sent': 1651556157.0010862, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556157.0231693, 'Latency': 0.022083044052124023}
Fetching updates from registry 10.0.0.5:5550
Request sent
Reply received as updatesub
[{'ip': '10.0.0.10', 'port': '5571', 'topics': ['light|20']}]
{'Topic': 'light|20', 'Value': 246, 'Sender': '10.0.0.10', 'Sent': 1651556158.812672, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556158.8353767, 'Latency': 0.0227048397064209}
{'Topic': 'light|20', 'Value': 74, 'Sender': '10.0.0.10', 'Sent': 1651556160.7346673, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556160.7574003, 'Latency': 0.022732973098754883}
{'Topic': 'light|20', 'Value': 271, 'Sender': '10.0.0.10', 'Sent': 1651556161.2375379, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556161.260761, 'Latency': 0.023223161697387695}
{'Topic': 'light|20', 'Value': 412, 'Sender': '10.0.0.10', 'Sent': 1651556161.3380256, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556161.3613434, 'Latency': 0.023317813873291016}
{'Topic': 'light|20', 'Value': 415, 'Sender': '10.0.0.10', 'Sent': 1651556162.3439364, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556162.3651607, 'Latency': 0.021224260330200195}
{'Topic': 'light|20', 'Value': 363, 'Sender': '10.0.0.10', 'Sent': 1651556163.048625, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556163.0711598, 'Latency': 0.022534847259521484}
{'Topic': 'light|20', 'Value': 209, 'Sender': '10.0.0.10', 'Sent': 1651556165.1599839, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556165.1819317, 'Latency': 0.021947860717773438}
{'Topic': 'light|20', 'Value': 395, 'Sender': '10.0.0.10', 'Sent': 1651556165.462733, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556165.4846787, 'Latency': 0.021945714950561523}
{'Topic': 'light|20', 'Value': 198, 'Sender': '10.0.0.10', 'Sent': 1651556165.6638744, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556165.6849546, 'Latency': 0.02108025550842285}
Fetching updates from registry 10.0.0.5:5550
Request sent
Reply received as updatesub
[{'ip': '10.0.0.10', 'port': '5571', 'topics': ['light|20']}]
{'Topic': 'light|20', 'Value': 415, 'Sender': '10.0.0.10', 'Sent': 1651556168.883612, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556168.907375, 'Latency': 0.023763179779052734}
{'Topic': 'light|20', 'Value': 147, 'Sender': '10.0.0.10', 'Sent': 1651556170.1916928, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556170.21364, 'Latency': 0.021947145462036133}
{'Topic': 'light|20', 'Value': 301, 'Sender': '10.0.0.10', 'Sent': 1651556171.1947548, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556171.216215, 'Latency': 0.02146005630493164}
{'Topic': 'light|20', 'Value': 87, 'Sender': '10.0.0.10', 'Sent': 1651556172.804689, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556172.8286319, 'Latency': 0.023942947387695312}
{'Topic': 'light|20', 'Value': 418, 'Sender': '10.0.0.10', 'Sent': 1651556173.5080779, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556173.532207, 'Latency': 0.024129152297973633}
{'Topic': 'light|20', 'Value': 47, 'Sender': '10.0.0.10', 'Sent': 1651556174.814603, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556174.8355727, 'Latency': 0.020969629287719727}
{'Topic': 'light|20', 'Value': 123, 'Sender': '10.0.0.10', 'Sent': 1651556175.2161646, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556175.2386024, 'Latency': 0.02243781089782715}
Fetching updates from registry 10.0.0.5:5550
Request sent
Reply received as updatesub
[{'ip': '10.0.0.10', 'port': '5571', 'topics': ['light|20']}]
{'Topic': 'light|20', 'Value': 13, 'Sender': '10.0.0.10', 'Sent': 1651556177.4304574, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556177.4546015, 'Latency': 0.02414417266845703}
{'Topic': 'light|20', 'Value': 180, 'Sender': '10.0.0.10', 'Sent': 1651556177.5313783, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556177.5546572, 'Latency': 0.02327895164489746}
{'Topic': 'light|20', 'Value': 392, 'Sender': '10.0.0.10', 'Sent': 1651556177.932793, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556177.9545808, 'Latency': 0.02178788185119629}
{'Topic': 'light|20', 'Value': 317, 'Sender': '10.0.0.10', 'Sent': 1651556178.3358874, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556178.3584754, 'Latency': 0.022588014602661133}
{'Topic': 'light|20', 'Value': 221, 'Sender': '10.0.0.10', 'Sent': 1651556178.837883, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556178.860703, 'Latency': 0.022819995880126953}
{'Topic': 'light|20', 'Value': 443, 'Sender': '10.0.0.10', 'Sent': 1651556179.5427537, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556179.5641544, 'Latency': 0.02140069007873535}
{'Topic': 'light|20', 'Value': 109, 'Sender': '10.0.0.10', 'Sent': 1651556180.3482497, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556180.370139, 'Latency': 0.021889209747314453}
{'Topic': 'light|20', 'Value': 112, 'Sender': '10.0.0.10', 'Sent': 1651556180.4487062, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556180.4732497, 'Latency': 0.02454352378845215}
{'Topic': 'light|20', 'Value': 115, 'Sender': '10.0.0.10', 'Sent': 1651556180.5498178, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556180.5750637, 'Latency': 0.02524590492248535}
{'Topic': 'light|20', 'Value': 220, 'Sender': '10.0.0.10', 'Sent': 1651556181.9569304, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556181.9821908, 'Latency': 0.025260448455810547}
{'Topic': 'light|20', 'Value': 282, 'Sender': '10.0.0.10', 'Sent': 1651556182.1598628, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556182.1818452, 'Latency': 0.021982431411743164}
{'Topic': 'light|20', 'Value': 402, 'Sender': '10.0.0.10', 'Sent': 1651556182.2604628, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556182.2820435, 'Latency': 0.02158069610595703}
{'Topic': 'light|20', 'Value': 76, 'Sender': '10.0.0.10', 'Sent': 1651556183.6737714, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556183.6955295, 'Latency': 0.021758079528808594}
{'Topic': 'light|20', 'Value': 395, 'Sender': '10.0.0.10', 'Sent': 1651556185.2834542, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556185.3060553, 'Latency': 0.02260112762451172}
Fetching updates from registry 10.0.0.5:5550
Request sent
Reply received as updatesub
[{'ip': '10.0.0.10', 'port': '5571', 'topics': ['light|20']}]
{'Topic': 'light|20', 'Value': 94, 'Sender': '10.0.0.10', 'Sent': 1651556187.9983585, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556188.021291, 'Latency': 0.02293252944946289}
{'Topic': 'light|20', 'Value': 71, 'Sender': '10.0.0.10', 'Sent': 1651556190.2173243, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556190.2399693, 'Latency': 0.022644996643066406}
{'Topic': 'light|20', 'Value': 248, 'Sender': '10.0.0.10', 'Sent': 1651556190.5197074, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556190.5412633, 'Latency': 0.02155590057373047}
{'Topic': 'light|20', 'Value': 300, 'Sender': '10.0.0.10', 'Sent': 1651556193.2440047, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556193.2687075, 'Latency': 0.024702787399291992}
{'Topic': 'light|20', 'Value': 6, 'Sender': '10.0.0.10', 'Sent': 1651556193.948186, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556193.9700198, 'Latency': 0.02183389663696289}
{'Topic': 'light|20', 'Value': 143, 'Sender': '10.0.0.10', 'Sent': 1651556194.250028, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556194.2713263, 'Latency': 0.02129840850830078}
{'Topic': 'light|20', 'Value': 233, 'Sender': '10.0.0.10', 'Sent': 1651556195.1548212, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556195.1784186, 'Latency': 0.02359747886657715}
Fetching updates from registry 10.0.0.5:5550
Request sent
Reply received as updatesub
[{'ip': '10.0.0.10', 'port': '5571', 'topics': ['light|20']}]
{'Topic': 'light|20', 'Value': 121, 'Sender': '10.0.0.10', 'Sent': 1651556202.710745, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556202.7331903, 'Latency': 0.022445201873779297}
{'Topic': 'light|20', 'Value': 344, 'Sender': '10.0.0.10', 'Sent': 1651556202.8113637, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556202.8335445, 'Latency': 0.022180795669555664}
{'Topic': 'light|20', 'Value': 451, 'Sender': '10.0.0.10', 'Sent': 1651556203.615565, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556203.6372187, 'Latency': 0.02165365219116211}
{'Topic': 'light|20', 'Value': 338, 'Sender': '10.0.0.10', 'Sent': 1651556204.6211202, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556204.6509502, 'Latency': 0.029829978942871094}
{'Topic': 'light|20', 'Value': 422, 'Sender': '10.0.0.10', 'Sent': 1651556206.6341043, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556206.6555452, 'Latency': 0.021440982818603516}
Fetching updates from registry 10.0.0.5:5550
Request sent
Reply received as updatesub
[{'ip': '10.0.0.10', 'port': '5571', 'topics': ['light|20']}]
{'Topic': 'light|20', 'Value': 184, 'Sender': '10.0.0.10', 'Sent': 1651556207.739882, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556207.763826, 'Latency': 0.02394390106201172}
{'Topic': 'light|20', 'Value': 410, 'Sender': '10.0.0.10', 'Sent': 1651556208.0430243, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556208.0665038, 'Latency': 0.023479461669921875}
{'Topic': 'light|20', 'Value': 274, 'Sender': '10.0.0.10', 'Sent': 1651556208.244656, 'Broker': 'None', 'Brokered': 0, 'Subscriber': '10.0.0.85', 'Received': 1651556208.2691565, 'Latency': 0.024500370025634766}
Fetching updates from registry 10.0.0.5:5550
Request sent
Reply received as updatesub
[{'ip': '10.0.0.26', 'port': '5571', 'topics': ['light|20']}]
Error: unable to lock polling for updates
Error: unable to lock polling for updates
Fetching updates from registry 10.0.0.5:5550
Request sent
Reply received as updatesub
[{'ip': '10.0.0.37', 'port': '5571', 'topics': ['light|20']}]
Error: unable to lock polling for updates
Error: unable to lock polling for updates
Fetching updates from registry 10.0.0.5:5550
Request sent
Reply received as updatesub
[]
Error: unable to lock polling for updates
Fetching updates from registry 10.0.0.5:5550
Request sent
Reply received as updatesub
[]
Error: unable to lock polling for updates
Fetching updates from registry 10.0.0.5:5550
Request sent
WARNING:kazoo.client:Connection dropped: outstanding heartbeat ping not received
WARNING:kazoo.client:Transition to CONNECTING
Current state is now = SUSPENDED
WARNING:kazoo.client:Connection dropped: socket connection error: None
WARNING:kazoo.client:Connection dropped: socket connection error: None
